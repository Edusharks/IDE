import{S as l,s as I,a as w,g as Y,b as U,c as q,d as H,i as _,e as N}from"./ide-tutorials-BlmyY8dx.js";const K=""+new URL("ESP32-Dli2DnSJ.png",import.meta.url).href,Z=""+new URL("Pico-BBV_Q1mS.png",import.meta.url).href;document.addEventListener("DOMContentLoaded",()=>{l.init(),O();function G(){const e=document.getElementById("tech-bg");if(!e)return;const t=[{icon:"fa-microchip",type:"chip"},{icon:"fa-memory",type:"chip"},{icon:"fa-wifi",type:"iot"},{icon:"fa-brain",type:"ai"},{icon:"fa-robot",type:"ai"},{icon:"fa-code",type:"code"},{icon:"fa-bolt",type:"iot"},{icon:"fa-network-wired",type:"iot"}],o=25;for(let n=0;n<o;n++){const a=document.createElement("i"),c=t[Math.floor(Math.random()*t.length)];a.classList.add("fa-solid",c.icon,"tech-item",`type-${c.type}`);const s=Math.random()*2+1.5,i=Math.random()*100,r=Math.random()*15+15,v=Math.random()*20;a.style.fontSize=`${s}rem`,a.style.left=`${i}%`,a.style.animationDuration=`${r}s`,a.style.animationDelay=`-${v}s`,e.appendChild(a)}}G();function R(e,t,o){const n=document.getElementById("custom-prompt-modal"),a=document.getElementById("custom-prompt-message"),c=document.getElementById("custom-prompt-input"),s=document.getElementById("custom-prompt-ok"),i=document.getElementById("custom-prompt-cancel");a.textContent=e,c.value=t||"",n.style.display="flex",requestAnimationFrame(()=>n.classList.add("active")),c.focus();const r=()=>{n.classList.remove("active"),setTimeout(()=>n.style.display="none",300),s.onclick=null,i.onclick=null};s.onclick=()=>{const v=c.value.trim();v&&(r(),o&&o(v))},i.onclick=()=>{r(),o&&o(null)}}function B(e,t){const o=document.getElementById("custom-confirm-modal"),n=document.getElementById("custom-confirm-message"),a=document.getElementById("custom-confirm-yes"),c=document.getElementById("custom-confirm-no");n.textContent=e,o.style.display="flex",requestAnimationFrame(()=>o.classList.add("active"));const s=()=>{o.classList.remove("active"),setTimeout(()=>o.style.display="none",300),a.onclick=null,c.onclick=null};a.onclick=()=>{s(),t&&t(!0)},c.onclick=()=>{s(),t&&t(!1)}}const b=document.getElementById("projects-grid"),k=document.getElementById("examples-grid"),j=document.getElementById("tutorials-grid"),y=document.getElementById("new-project-modal"),p=document.getElementById("modal-project-name"),x=document.querySelector(".board-grid"),L=document.getElementById("modal-create-btn");let f=null,u=[],d=null;const W=[{id:"esp32",name:"ESP32",img:K},{id:"pico",name:"Pico W",img:Z}],F=[{name:"Gesture Mouse",boardId:"esp32",desc:"Control mouse with AI hand tracking."},{name:"IoT Dashboard",boardId:"esp32",desc:"Wifi connected sensor monitor."},{name:"Physics Game",boardId:"simulation",desc:"Browser-based circuit simulation."}];function O(){const e=document.getElementById("tech-bg"),t=document.getElementById("animation-toggle"),o=i=>{e&&(e.style.display=i==="enabled"?"block":"none"),t&&(t.checked=i==="enabled")};l.get("animations")||l.set("animations","enabled");const n=l.get("animations");o(n),t&&(t.onchange=i=>{const r=i.target.checked?"enabled":"disabled";l.set("animations",r),o(r)}),l.get("theme")||l.set("theme","light");const a=l.get("color")||"#4f46e5",c=l.get("theme")||"light";C(a),$(c);const s=document.getElementById("settings-modal");document.getElementById("open-settings-btn").onclick=()=>{s.style.display="flex",requestAnimationFrame(()=>s.classList.add("active"))},document.getElementById("close-settings-btn").onclick=()=>{s.classList.remove("active"),setTimeout(()=>s.style.display="none",300)},document.querySelectorAll(".color-dot").forEach(i=>{i.onclick=()=>{const r=i.dataset.color;C(r),l.set("color",r)},i.dataset.color===a&&i.classList.add("active")})}function C(e){document.documentElement.style.setProperty("--primary",e),document.querySelectorAll(".color-dot").forEach(t=>{t.classList.toggle("active",t.dataset.color===e)})}function $(e){const t=document.getElementById("theme-btn-light"),o=document.getElementById("theme-btn-dark");t&&o&&(e==="light"?(t.classList.add("active"),o.classList.remove("active")):(t.classList.remove("active"),o.classList.add("active")))}window.setTheme=e=>{l.set("theme",e),$(e)};const z=document.getElementById("import-project-btn"),E=document.getElementById("import-file-input");z.onclick=()=>E.click(),E.onchange=async e=>{const t=e.target.files[0];if(t){try{if(t.name.endsWith(".json")){const o=await t.text(),n=JSON.parse(o);if(!n.name||!n.boardId)throw new Error("Invalid project file");u.some(a=>a.name===n.name)?B(`Overwrite existing project "${n.name}"?`,async a=>{a&&await M(n)}):await M(n)}else alert("Please select a .json project file.")}catch(o){alert("Import failed: "+o.message)}E.value=""}};async function M(e){const t=Date.now();await I({name:e.name,boardId:e.boardId,createdAt:t,modifiedAt:t,extensions:e.extensions||[],dashboard:e.dashboard||null}),e.workspace&&await w(e.name,e.workspace),m()}function T(e){return e==="esp32"?'<i class="fa-solid fa-microchip"></i>':e==="pico"?'<i class="fa-solid fa-memory"></i>':'<i class="fa-solid fa-gamepad"></i>'}async function m(){u=await Y();const e=document.getElementById("search-projects").value.toLowerCase(),t=document.getElementById("sort-projects").value;let o=u.filter(n=>n.name.toLowerCase().includes(e));o.sort((n,a)=>t==="name-asc"?n.name.localeCompare(a.name):a.modifiedAt-n.modifiedAt),Array.from(b.children).forEach(n=>{n.id!=="create-new-project-btn"&&n.remove()}),o.forEach(n=>{const a=document.createElement("div");a.className="card",a.innerHTML=`
                        <div class="card-top">
                            <div class="card-icon" style="background: var(--primary-light); color: var(--primary);">${T(n.boardId)}</div>
                            <button class="card-menu-btn" title="Options"><i class="fa-solid fa-ellipsis-vertical"></i></button>
                        </div>
                        <div class="card-content">
                            <h3>${n.name}</h3>
                            <p>${n.boardId==="simulation"?"Simulation":n.boardId.toUpperCase()}</p>
                            <div class="card-meta">Modified: ${new Date(n.modifiedAt).toLocaleDateString()}</div>
                        </div>
                    `,a.onclick=c=>{c.target.closest(".card-menu-btn")||D(n)},a.querySelector(".card-menu-btn").onclick=c=>{c.stopPropagation(),X(c,n)},b.appendChild(a)})}function J(){k.innerHTML="",F.forEach(e=>{const t=document.createElement("div");t.className="card",t.innerHTML=`
                        <div class="card-top">
                            <div class="card-icon" style="background:#e0f2fe; color:#0284c7;">${T(e.boardId)}</div>
                        </div>
                        <div class="card-content">
                            <span class="tag tag-blue">Example</span>
                            <h3>${e.name}</h3>
                            <p>${e.desc}</p>
                        </div>
                    `,t.onclick=()=>alert("Example cloning not implemented in demo."),k.appendChild(t)}),j.innerHTML="",_.forEach(e=>{const t=document.createElement("div");t.className="card",t.innerHTML=`
                        <div class="card-top">
                            <div class="card-icon" style="background:#f3e8ff; color:#9333ea;">${e.icon}</div>
                        </div>
                        <div class="card-content">
                            <span class="tag tag-purple">Tutorial</span>
                            <h3>${e.title}</h3>
                            <p>${e.description}</p>
                        </div>
                    `,t.onclick=()=>Q(e),j.appendChild(t)})}function Q(e){P(),p.value=e.title,g()}function A(){x.innerHTML="",W.forEach(e=>{const t=document.createElement("div");t.className="board-option",f===e.id&&t.classList.add("selected"),t.innerHTML=`<img src="${e.img}"><h4>${e.name}</h4>`,t.onclick=()=>{f=e.id,A(),g()},x.appendChild(t)})}function g(){const e=p.value.trim();L.disabled=!(e&&f)}function P(){y.style.display="flex",setTimeout(()=>y.classList.add("active"),10),p.focus(),f=null,A(),g()}function V(){y.classList.remove("active"),setTimeout(()=>y.style.display="none",300)}L.onclick=async()=>{const e=p.value.trim();if(u.some(o=>o.name===e))return alert("Name taken!");const t={name:e,boardId:f,createdAt:Date.now(),modifiedAt:Date.now(),extensions:[],dashboard:null};await I(t),D(t)};const h=document.getElementById("project-context-menu");function X(e,t){d=t,h.style.display="block";const o=Math.min(e.clientX,window.innerWidth-200);h.style.left=o+"px",h.style.top=e.clientY+"px",setTimeout(()=>document.addEventListener("click",S),10)}function S(){h.style.display="none",document.removeEventListener("click",S)}document.getElementById("ctx-delete").onclick=()=>{d&&B(`Delete project "${d.name}"?`,async e=>{e&&(await N(d.name),m())})},document.getElementById("ctx-rename").onclick=()=>{if(!d)return;const e=d.name;R("Rename project:",e,async t=>{if(t&&t!==e){if(u.some(c=>c.name===t))return alert("Name already exists.");const o=await U(e),n=await q(e);await N(e);const a={...d,name:t,modifiedAt:Date.now()};await I(a),o&&await w(t,o),n&&await H(t,n),m()}})},document.getElementById("ctx-duplicate").onclick=async()=>{if(!d)return;const e=d.name;let t=`${e} Copy`,o=1;for(;u.some(c=>c.name===t);)o++,t=`${e} Copy ${o}`;const n=await U(e),a=await q(e);await I({...d,name:t,createdAt:Date.now(),modifiedAt:Date.now()}),n&&await w(t,n),a&&await H(t,a),m()},document.getElementById("create-new-project-btn").onclick=P,document.getElementById("modal-cancel-btn").onclick=V,p.oninput=g,document.getElementById("search-projects").oninput=m,document.getElementById("sort-projects").onchange=m;function D(e){const t=e.boardId==="simulation"?`simulation-ide.html?project=${encodeURIComponent(e.name)}`:`ide.html?project=${encodeURIComponent(e.name)}&board=${encodeURIComponent(e.boardId)}`;window.location.href=t}m(),J()});
