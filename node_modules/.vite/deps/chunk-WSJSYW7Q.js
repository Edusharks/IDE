import {
  EditorWorker,
  EditorWorkerHost,
  WebWorkerServer
} from "./chunk-L7FKPG2M.js";

// node_modules/monaco-editor/esm/vs/base/common/worker/webWorkerBootstrap.js
var initialized = false;
function initialize(factory) {
  if (initialized) {
    throw new Error("WebWorker already initialized!");
  }
  initialized = true;
  const webWorkerServer = new WebWorkerServer((msg) => globalThis.postMessage(msg), (workerServer) => factory(workerServer));
  globalThis.onmessage = (e) => {
    webWorkerServer.onmessage(e.data);
  };
  return webWorkerServer;
}

// node_modules/monaco-editor/esm/vs/editor/editor.worker.start.js
function start(createClient) {
  let client;
  const webWorkerServer = initialize((workerServer) => {
    const editorWorkerHost = EditorWorkerHost.getChannel(workerServer);
    const host = new Proxy({}, {
      get(target, prop, receiver) {
        if (prop === "then") {
          return void 0;
        }
        if (typeof prop !== "string") {
          throw new Error(`Not supported`);
        }
        return (...args) => {
          return editorWorkerHost.$fhr(prop, args);
        };
      }
    });
    const ctx = {
      host,
      getMirrorModels: () => {
        return webWorkerServer.requestHandler.getModels();
      }
    };
    client = createClient(ctx);
    return new EditorWorker(client);
  });
  return client;
}

export {
  start
};
//# sourceMappingURL=chunk-WSJSYW7Q.js.map
